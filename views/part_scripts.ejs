<script>
      $(document).ready(function(){
        $('.follow-button').click(function(){

          var button = $(this);
          var username = button.attr("username");
          $.ajax({
            url:"/api/follow/"+username,
            type:"GET",
            success:function(){
              button = $('.follow-button[username="'+username+'"]');
              button.toggleClass("btn-info");
              button.toggleClass("btn-success");
              if(button.text()=="following"){
                button.text("follow");
              }else{
                button.text("following");
              }
            }
          });
        });
        //for following buttons' states
        var following = <%- following %>;
        var buttons = $('.follow-button');
        for (var i = buttons.length - 1; i >= 0; i--) {
          
          var username = $(buttons[i]).attr("username");
          if(following.indexOf(username)>-1){
            $(buttons[i]).text('following');
            $(buttons[i]).removeClass('btn-info');
            $(buttons[i]).addClass('btn-success');
          }
        };
      });
</script>